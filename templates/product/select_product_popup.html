<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œí’ˆ ì„ íƒ</title>
    
    <style>
        .product-item {
            display: flex;
            align-items: center;
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            justify-content: space-between;
        }

        .product-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-right: 15px;
            border-radius: 5px;
        }

        .product-info {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .product-tags {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }

        .tag {
            background-color: #f1f1f1;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 12px;
        }

        .select-btn {
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .select-btn:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <!-- ğŸ” ì¥ê³  ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€ -->
    <form method="get" action="{% url 'product:select_product' %}">
        <input type="text" name="q" class="form-control" placeholder="ì œí’ˆì„ ê²€ìƒ‰í•˜ì„¸ìš”..." value="{{ query|default:'' }}">
        <button type="submit" class="btn btn-primary">ê²€ìƒ‰</button>
    </form>

    <!-- ğŸ“œ ê²€ìƒ‰ëœ ì œí’ˆ ëª©ë¡ -->
    <div id="productList">
        {% for p in product %}
            <div class="product-item">
                <span>{{ forloop.counter }}</span> <!-- ìˆœë²ˆ ì¶”ê°€ -->
                <img src="{{ p.product_image_url }}" alt="ì œí’ˆ ì´ë¯¸ì§€">
                <div class="product-info">
                    <p class="product-name"><strong>{{ p.product_name }}</strong></p>
                    <div class="product-tags">
                        <span class="tag">{{ p.product_price }}ì›</span>
                        <span class="tag">{{ p.convenient_store_name }}</span>
                        <span class="tag">{{ p.product_category_name }}</span>
                    </div>
                </div>
                <button class="select-btn" onclick="selectProduct('{{ p.product_id }}', '{{ p.product_name }}', '{{ p.product_image_url }}')">ì„ íƒ</button>
            </div>
        {% empty %}
            <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        {% endfor %}
    </div>

    <script>
    function selectProduct(productId, productName, productImageUrl) {
        window.opener.setSelectedProduct(productId, productName, productImageUrl);  // ë¶€ëª¨ ì°½ì˜ í•¨ìˆ˜ í˜¸ì¶œ
        window.close();  // íŒì—… ë‹«ê¸°
    }
    </script>

</body>
</html>
